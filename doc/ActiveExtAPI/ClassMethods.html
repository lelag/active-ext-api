<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Module: ActiveExtAPI::ClassMethods</title>
<link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo; 
    <span class='title'><a href="../ActiveExtAPI.html" title="ActiveExtAPI (module)">ActiveExtAPI</a></span>
     &raquo; 
    <span class="title">ClassMethods</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: ActiveExtAPI::ClassMethods
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/active_ext_api/active_ext_api.rb</dd>
  
</dl>
<div class="clear"></div>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#acts_as_direct_ext_api-instance_method" title="#acts_as_direct_ext_api (instance method)">- (Object) <strong>acts_as_direct_ext_api</strong>(direct_methods = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Register the Ext API methods as available to the Direct RPC calls.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#call_func-instance_method" title="#call_func (instance method)">- (Object) <strong>call_func</strong>(ar, m, v = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Recursively call method is associated ActiveRecord object.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ext_create-instance_method" title="#ext_create (instance method)">- (Hash) <strong>ext_create</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Create one or several records Responds to creation requests from an ExtJS
Store.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ext_create_record-instance_method" title="#ext_create_record (instance method)">- (Hash) <strong>ext_create_record</strong>(record = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Helper method : create a single record If provided with a &#8220;id&#8221;
attributes, it will be ignored.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ext_destroy-instance_method" title="#ext_destroy (instance method)">- (Hash) <strong>ext_destroy</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Delete one or several records Responds to update requests from an ExtJS
Store.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ext_read-instance_method" title="#ext_read (instance method)">- (Hash) <strong>ext_read</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Return a list of records that can be used to load an ExtJS Store.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ext_update-instance_method" title="#ext_update (instance method)">- (Hash) <strong>ext_update</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Update one or several records Responds to update requests from an ExtJS
Store.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ext_update_record-instance_method" title="#ext_update_record (instance method)">- (Hash) <strong>ext_update_record</strong>(record = {}, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Helper method : update a single record.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#filter_sort-instance_method" title="#filter_sort (instance method)">- (Hash) <strong>filter_sort</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Transform Ext provided :sort / :dir options into rail&#8217;s :order
options.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#filter_sort_tables-instance_method" title="#filter_sort_tables (instance method)">- (Object) <strong>filter_sort_tables</strong>(v) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Transform a request to sort on a linked model into the table names.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_total_count-instance_method" title="#get_total_count (instance method)">- (Integer) <strong>get_total_count</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Get the total count for a find query ignoring limits.
</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="acts_as_direct_ext_api-instance_method">
  
    - (<tt>Object</tt>) <strong>acts_as_direct_ext_api</strong>(direct_methods = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Register the Ext API methods as available to the Direct RPC calls.
</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h3>Examples:</h3>
    
      <h4><div class='inline'><p>
make a foobar method taking 1 argument available to the Direct RPC API.
</p>
</div></h4>
      <pre class="example code"><span class='acts_as_direct_ext_api identifier id'>acts_as_direct_ext_api</span> <span class='lbrace token'>{</span><span class='symbol val'>:foobar</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='rbrace token'>}</span>
</pre>
    
  </div>
<h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>direct</span>
      
      
      
        &mdash;
        <div class='inline'><p>
methods direct_methods that can be made accessible through the ActiveDirect
api
</p>
</div>
      
    </li>
  
</ul>
<h3>Author:</h3>
<ul class="author">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>
Adapted from code from Stone Gao&#8217;s ActiveDirect library
github.com/stonegao/active-direct
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25
26
27
28
29
30
31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 23</span>

<span class='def def kw'>def</span> <span class='acts_as_direct_ext_api identifier id'>acts_as_direct_ext_api</span><span class='lparen token'>(</span><span class='direct_methods identifier id'>direct_methods</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='raise identifier id'>raise</span> <span class='string val'>&quot;ActiveDirect was not found &quot;</span> <span class='if if_mod kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='methods identifier id'>methods</span><span class='dot token'>.</span><span class='include? fid id'>include?</span> <span class='string val'>&quot;acts_as_direct&quot;</span> <span class='eq op'>==</span> <span class='false false kw'>false</span> 
    <span class='direct_methods identifier id'>direct_methods</span><span class='dot token'>.</span><span class='stringify_keys! fid id'>stringify_keys!</span><span class='dot token'>.</span><span class='merge! fid id'>merge!</span><span class='lparen token'>(</span><span class='DEFAULT_METHODS constant id'>DEFAULT_METHODS</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='mtd identifier id'>mtd</span><span class='comma token'>,</span> <span class='mcfg identifier id'>mcfg</span><span class='bitor op'>|</span>
      <span class='if if kw'>if</span> <span class='mcfg identifier id'>mcfg</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span>
        <span class='ActiveDirect constant id'>ActiveDirect</span><span class='colon2 op'>::</span><span class='Config constant id'>Config</span><span class='dot token'>.</span><span class='method_config identifier id'>method_config</span><span class='lbrack token'>[</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrace token'>{</span><span class='string val'>'name'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='mtd identifier id'>mtd</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='merge! fid id'>merge!</span><span class='lparen token'>(</span><span class='mcfg identifier id'>mcfg</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
        <span class='ActiveDirect constant id'>ActiveDirect</span><span class='colon2 op'>::</span><span class='Config constant id'>Config</span><span class='dot token'>.</span><span class='method_config identifier id'>method_config</span><span class='lbrack token'>[</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrace token'>{</span> <span class='string val'>'name'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='mtd identifier id'>mtd</span><span class='comma token'>,</span> <span class='string val'>'len'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='mcfg identifier id'>mcfg</span> <span class='rbrace token'>}</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="call_func-instance_method">
  
    - (<tt>Object</tt>) <strong>call_func</strong>(ar, m, v = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Recursively call method is associated ActiveRecord object
</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h3>Examples:</h3>
    
      <h4><div class='inline'><p>
calling book.author.country.name= &#8220;France&#8220;
</p>
</div></h4>
      <pre class="example code"><span class='call_func identifier id'>call_func</span><span class='lparen token'>(</span><span class='book identifier id'>book</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>&quot;author&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;country&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='string val'>&quot;France&quot;</span><span class='rparen token'>)</span>
</pre>
    
      <h4><div class='inline'><p>
calling book.author.country.save
</p>
</div></h4>
      <pre class="example code"><span class='call_func identifier id'>call_func</span><span class='lparen token'>(</span><span class='book identifier id'>book</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>&quot;author&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;country&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;save&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
</pre>
    
  </div>
<h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
        <span class='name'>ar</span>
      
      
      
        &mdash;
        <div class='inline'><p>
The base object (here an ActiveRecord::Base instance) on which to start the
call chain
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
        <span class='name'>m</span>
      
      
      
        &mdash;
        <div class='inline'><p>
An array containing the chain of method to call
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>optional Object</tt>)</span>
      
      
        <span class='name'>v</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
An optional value that will be assigned to the last item in the chain.
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'></span>
      
      
      
      
        
        <div class='inline'><p>
The return value of the last method call in the chain
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 58</span>

<span class='def def kw'>def</span> <span class='call_func identifier id'>call_func</span><span class='lparen token'>(</span><span class='ar identifier id'>ar</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='mm identifier id'>mm</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rbrack token'>]</span> 
  <span class='if if kw'>if</span> <span class='mm identifier id'>mm</span> <span class='eq op'>==</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> 
    <span class='if if kw'>if</span> <span class='v identifier id'>v</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span>
      <span class='ms identifier id'>ms</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='plus op'>+</span><span class='string val'>&quot;=&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span>
      <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='send identifier id'>send</span> <span class='ms identifier id'>ms</span><span class='comma token'>,</span> <span class='v identifier id'>v</span> 
    <span class='else else kw'>else</span>
      <span class='ms identifier id'>ms</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span>
      <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='send identifier id'>send</span> <span class='ms identifier id'>ms</span> 
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='ms identifier id'>ms</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span>
    <span class='nar identifier id'>nar</span> <span class='assign token'>=</span> <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='send identifier id'>send</span> <span class='ms identifier id'>ms</span>
    <span class='call_func identifier id'>call_func</span> <span class='nar identifier id'>nar</span><span class='comma token'>,</span> <span class='mm identifier id'>mm</span><span class='comma token'>,</span> <span class='v identifier id'>v</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ext_create-instance_method">
  
    - (<tt>Hash</tt>) <strong>ext_create</strong>(opts = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Create one or several records Responds to creation requests from an ExtJS
Store
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>the</span>
      
      
      
        &mdash;
        <div class='inline'><p>
request options
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>opts</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
a customizable set of options
</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <h3>Options Hash (<tt>opts</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="type">(<tt>Array</tt>)</span>
          <span class="name">:data</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
an array of record to create
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>Hash</tt>)</span>
          <span class="name">:data</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
a record to create
</p>
</div>
        </tr>
      
    </ul>
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
ExtJS compliant response containing the created records (with id) :success
: true if one or more record were created  :data : an array of records
:message : optional messages
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 193</span>

<span class='def def kw'>def</span> <span class='ext_create identifier id'>ext_create</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='string val'>&quot;No data arguments in request&quot;</span> <span class='if if_mod kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>
  <span class='er identifier id'>er</span> <span class='assign token'>=</span> <span class='ExtResponse constant id'>ExtResponse</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='new_records identifier id'>new_records</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span>
  <span class='created identifier id'>created</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='new_records identifier id'>new_records</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span> <span class='Array constant id'>Array</span><span class='rparen token'>)</span> 
    <span class='new_records identifier id'>new_records</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='r identifier id'>r</span><span class='bitor op'>|</span>
      <span class='begin begin kw'>begin</span>
        <span class='new_record identifier id'>new_record</span> <span class='assign token'>=</span> <span class='ext_create_record identifier id'>ext_create_record</span> <span class='r identifier id'>r</span>
        <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_data identifier id'>add_data</span><span class='lparen token'>(</span><span class='new_record identifier id'>new_record</span><span class='rparen token'>)</span>
        <span class='created identifier id'>created</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span><span class='new_record identifier id'>new_record</span><span class='lbrack token'>[</span><span class='string val'>&quot;id&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='rescue rescue kw'>rescue</span>
        <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='dstring node'>&quot;Warning : Could not create record #{r.to_s}. #{$!}\r\n&quot;</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='r identifier id'>r</span> <span class='assign token'>=</span> <span class='new_records identifier id'>new_records</span> 
    <span class='begin begin kw'>begin</span>
      <span class='new_record identifier id'>new_record</span> <span class='assign token'>=</span> <span class='ext_create_record identifier id'>ext_create_record</span> <span class='r identifier id'>r</span>
      <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_data identifier id'>add_data</span><span class='lparen token'>(</span><span class='new_record identifier id'>new_record</span><span class='rparen token'>)</span>
      <span class='created identifier id'>created</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span><span class='new_record identifier id'>new_record</span><span class='lbrack token'>[</span><span class='string val'>&quot;id&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='rescue rescue kw'>rescue</span>
      <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='dstring node'>&quot;Warning : Could not create record #{r.to_s}. #{$!}\r\n&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='created identifier id'>created</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='dstring node'>&quot;Successfully created #{created.length} records with id : &quot;</span> <span class='plus op'>+</span> <span class='created identifier id'>created</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>', '</span><span class='rparen token'>)</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='success identifier id'>success</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='else else kw'>else</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='string val'>&quot;No record created.&quot;</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='success identifier id'>success</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>
  <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span> 
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ext_create_record-instance_method">
  
    - (<tt>Hash</tt>) <strong>ext_create_record</strong>(record = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Helper method : create a single record If provided with a &#8220;id&#8221;
attributes, it will be ignored
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>a</span>
      
      
      
        &mdash;
        <div class='inline'><p>
record to create
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
a hash containng the new record&#8217;s attribute including the new id.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


170
171
172
173
174
175
176
177
178
179
180</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 170</span>

<span class='def def kw'>def</span> <span class='ext_create_record identifier id'>ext_create_record</span><span class='lparen token'>(</span><span class='record identifier id'>record</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='ar identifier id'>ar</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='each_pair identifier id'>each_pair</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='key identifier id'>key</span> <span class='neq op'>!=</span> <span class='string val'>&quot;id&quot;</span><span class='rparen token'>)</span>
      <span class='sym identifier id'>sym</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='key identifier id'>key</span><span class='plus op'>+</span><span class='string val'>&quot;=&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span>
      <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='send identifier id'>send</span> <span class='sym identifier id'>sym</span><span class='comma token'>,</span> <span class='value identifier id'>value</span> 
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='save identifier id'>save</span>
  <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ext_destroy-instance_method">
  
    - (<tt>Hash</tt>) <strong>ext_destroy</strong>(opts = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Delete one or several records Responds to update requests from an ExtJS
Store
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>the</span>
      
      
      
        &mdash;
        <div class='inline'><p>
request options
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>opts</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
a customizable set of options
</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <h3>Options Hash (<tt>opts</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="type">(<tt>Array</tt>)</span>
          <span class="name">:data</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
an array of record to delete
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>Hash</tt>)</span>
          <span class="name">:data</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
a record to delete
</p>
</div>
        </tr>
      
    </ul>
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
ExtJS compliant response contaning a message :success : true if one or more
record were deleted :data : an array of records :message : optional
messages
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 350</span>

<span class='def def kw'>def</span> <span class='ext_destroy identifier id'>ext_destroy</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='string val'>&quot;No data arguments in request&quot;</span> <span class='if if_mod kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>
  <span class='record_ids identifier id'>record_ids</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span>
  <span class='er identifier id'>er</span> <span class='assign token'>=</span> <span class='ExtResponse constant id'>ExtResponse</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='deleted identifier id'>deleted</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='record_ids identifier id'>record_ids</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span> <span class='Array constant id'>Array</span><span class='rparen token'>)</span> 
    <span class='record_ids identifier id'>record_ids</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='id identifier id'>id</span><span class='bitor op'>|</span>
      <span class='begin begin kw'>begin</span>
        <span class='raise identifier id'>raise</span> <span class='string val'>&quot;record not found&quot;</span> <span class='if if_mod kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
        <span class='deleted identifier id'>deleted</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
      <span class='rescue rescue kw'>rescue</span>
        <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='dstring node'>&quot;Warning : Could not destroy record with id #{id} : #{$!}\r\n&quot;</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='begin begin kw'>begin</span>
      <span class='raise identifier id'>raise</span> <span class='string val'>&quot;record not found&quot;</span> <span class='if if_mod kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='record_ids identifier id'>record_ids</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
      <span class='deleted identifier id'>deleted</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span><span class='record_ids identifier id'>record_ids</span><span class='rparen token'>)</span>
    <span class='rescue rescue kw'>rescue</span>
      <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='dstring node'>&quot;Warning : Could not destroy record with id #{record_ids} : #{$!}\r\n&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='deleted identifier id'>deleted</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='dstring node'>&quot;Successfully deleted #{deleted.length} records with id : &quot;</span> <span class='plus op'>+</span> <span class='deleted identifier id'>deleted</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>', '</span><span class='rparen token'>)</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='success identifier id'>success</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='else else kw'>else</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='string val'>&quot;No record deleted.&quot;</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='success identifier id'>success</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>
  <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ext_read-instance_method">
  
    - (<tt>Hash</tt>) <strong>ext_read</strong>(opts = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Return a list of records that can be used to load an ExtJS Store
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>opts</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
the options provided by ExtJS to request records
</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <h3>Options Hash (<tt>opts</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:sort</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the attributes that must be used to sort
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:dir</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the direction of the sort
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="name">:limit</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the maximum number of record to return
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="name">:offset</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the number of records to skip
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="name">:start</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
alias for :offset
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>Mixed</tt>)</span>
          <span class="name">Any</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
option recognised by ActiveRecord::Base.find
</p>
</div>
        </tr>
      
    </ul>
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
ExtJS compliant response containing the requested records :success :
normally always true (even if no record send) :total : the number of total
records (ignoring limits) :data : an array of records :message : optional
messages
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 138</span>

<span class='def def kw'>def</span> <span class='ext_read identifier id'>ext_read</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='er identifier id'>er</span> <span class='assign token'>=</span> <span class='ExtResponse constant id'>ExtResponse</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='filter_sort identifier id'>filter_sort</span> <span class='opts identifier id'>opts</span> 

  <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:limit</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span> 
      <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:start</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span>
        <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:offset</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span> <span class='symbol val'>:start</span>
      <span class='end end kw'>end</span>
      <span class='total identifier id'>total</span> <span class='assign token'>=</span> <span class='get_total_count identifier id'>get_total_count</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='clone identifier id'>clone</span> <span class='comment val'># total must contains the total number of record without limit/offset</span>
  <span class='end end kw'>end</span>

  <span class='list identifier id'>list</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
  <span class='list identifier id'>list</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='r identifier id'>r</span><span class='bitor op'>|</span>
    <span class='s identifier id'>s</span> <span class='assign token'>=</span> <span class='r identifier id'>r</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span>
    <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:include</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>   <span class='comment val'># add assotiations if requested {attr_id, attr : {id: ...</span>
      <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:include</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='j identifier id'>j</span><span class='bitor op'>|</span>
        <span class='s identifier id'>s</span><span class='lbrack token'>[</span><span class='j identifier id'>j</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='r identifier id'>r</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='j identifier id'>j</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_data identifier id'>add_data</span> <span class='s identifier id'>s</span>
  <span class='end end kw'>end</span>

  <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='symbol val'>:total</span><span class='comma token'>,</span> <span class='total identifier id'>total</span> <span class='orop op'>||</span> <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='data identifier id'>data</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='rparen token'>)</span>
  <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ext_update-instance_method">
  
    - (<tt>Hash</tt>) <strong>ext_update</strong>(opts = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Update one or several records Responds to update requests from an ExtJS
Store
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>the</span>
      
      
      
        &mdash;
        <div class='inline'><p>
request options
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>opts</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
a customizable set of options
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>options</span>
      
      
      
        &mdash;
        <div class='inline'><p>
a customizable set of options
</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <h3>Options Hash (<tt>opts</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="type">(<tt>Array</tt>)</span>
          <span class="name">:data</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
an array of record to update
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>Hash</tt>)</span>
          <span class="name">:data</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
a record to update
</p>
</div>
        </tr>
      
    </ul>
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
ExtJS compliant response containing the updated records (with id) :success
: true if one or more record were updated :data : an array of records
:message : optional messages
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 302</span>

<span class='def def kw'>def</span> <span class='ext_update identifier id'>ext_update</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='string val'>&quot;No data arguments in request&quot;</span> <span class='if if_mod kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>
  <span class='er identifier id'>er</span> <span class='assign token'>=</span> <span class='ExtResponse constant id'>ExtResponse</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='records identifier id'>records</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span>
  <span class='updated identifier id'>updated</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='records identifier id'>records</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span> <span class='Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='r identifier id'>r</span><span class='bitor op'>|</span>
      <span class='begin begin kw'>begin</span>
        <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_data identifier id'>add_data</span><span class='lparen token'>(</span><span class='ext_update_record identifier id'>ext_update_record</span> <span class='r identifier id'>r</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
        <span class='updated identifier id'>updated</span><span class='dot token'>.</span><span class='push identifier id'>push</span> <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='string val'>&quot;id&quot;</span><span class='rbrack token'>]</span>
      <span class='rescue rescue kw'>rescue</span>
        <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='dstring node'>&quot;Warning : Could not update record with id #{r[&quot;id&quot;]}. #{$!}&quot;</span>
        <span class='raise identifier id'>raise</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='r identifier id'>r</span> <span class='assign token'>=</span> <span class='records identifier id'>records</span> 
    <span class='begin begin kw'>begin</span>
      <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_data identifier id'>add_data</span><span class='lparen token'>(</span><span class='ext_update_record identifier id'>ext_update_record</span> <span class='r identifier id'>r</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
      <span class='updated identifier id'>updated</span><span class='dot token'>.</span><span class='push identifier id'>push</span> <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='string val'>&quot;id&quot;</span><span class='rbrack token'>]</span>
    <span class='rescue rescue kw'>rescue</span>
      <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='dstring node'>&quot;Warning : Could not update record with id #{r[&quot;id&quot;]}. #{$!}\r\n&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='updated identifier id'>updated</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='dstring node'>&quot;Successfully updated #{updated.length} records with id : &quot;</span> <span class='plus op'>+</span> <span class='updated identifier id'>updated</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>', '</span><span class='rparen token'>)</span>
    <span class='success identifier id'>success</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='else else kw'>else</span>
    <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='add_message identifier id'>add_message</span> <span class='string val'>&quot;No record updated.&quot;</span>
    <span class='success identifier id'>success</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='success identifier id'>success</span> <span class='assign token'>=</span> <span class='success identifier id'>success</span> 
  <span class='er identifier id'>er</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ext_update_record-instance_method">
  
    - (<tt>Hash</tt>) <strong>ext_update_record</strong>(record = {}, options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Helper method : update a single record
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>record</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
the record to update. It can contain a full record or just some attributes
and an id
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>optional Hash</tt>)</span>
      
      
        <span class='name'>options</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
regarding record creation
</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <h3>Options Hash (<tt>options</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:on_edit</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
&#8220;find_or_create&#8221; on a secondary model update, it will try to
find an existing record with the value or will create a new one. 
&#8220;force_create&#8221; will always result in a new record creation
</p>
</div>
        </tr>
      
    </ul>
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the attributes of the updated models with optional secondary models
attributes.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 239</span>

<span class='def def kw'>def</span> <span class='ext_update_record identifier id'>ext_update_record</span><span class='lparen token'>(</span><span class='record identifier id'>record</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='secondary_models identifier id'>secondary_models</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='raise identifier id'>raise</span> <span class='string val'>&quot;Record is empty&quot;</span> <span class='if if_mod kw'>if</span> <span class='record identifier id'>record</span> <span class='eq op'>==</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> 
  <span class='ar identifier id'>ar</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='lbrack token'>[</span><span class='string val'>&quot;id&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='each_pair identifier id'>each_pair</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='key_array identifier id'>key_array</span> <span class='assign token'>=</span> <span class='key identifier id'>key</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>&quot;.&quot;</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='key_array identifier id'>key_array</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
      <span class='sm identifier id'>sm</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='key_array identifier id'>key_array</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='key_array identifier id'>key_array</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='secondary_models identifier id'>secondary_models</span><span class='dot token'>.</span><span class='push identifier id'>push</span> <span class='sm identifier id'>sm</span>

      <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:on_edit</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;find_or_create&quot;</span> 
        <span class='comment val'>#try to find an existing model that match the new value </span>
        <span class='comment val'>#TODO : this could be replace by find_or_create_by_xxxx</span>
        <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='Kernel constant id'>Kernel</span><span class='dot token'>.</span><span class='const_get identifier id'>const_get</span><span class='lparen token'>(</span><span class='sm identifier id'>sm</span><span class='lbrack token'>[</span><span class='minus op'>-</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='capitalize identifier id'>capitalize</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:first</span><span class='comma token'>,</span> <span class='lbrace token'>{</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='key_array identifier id'>key_array</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='value identifier id'>value</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='m identifier id'>m</span>
          <span class='sm_clone identifier id'>sm_clone</span> <span class='assign token'>=</span> <span class='sm identifier id'>sm</span><span class='dot token'>.</span><span class='clone identifier id'>clone</span>
          <span class='sm_clone identifier id'>sm_clone</span><span class='dot token'>.</span><span class='push identifier id'>push</span> <span class='string val'>&quot;clone&quot;</span> 
          <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='call_func identifier id'>call_func</span><span class='lparen token'>(</span><span class='ar identifier id'>ar</span><span class='comma token'>,</span> <span class='sm_clone identifier id'>sm_clone</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
        <span class='call_func identifier id'>call_func</span><span class='lparen token'>(</span><span class='ar identifier id'>ar</span><span class='comma token'>,</span> <span class='sm identifier id'>sm</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='rparen token'>)</span>          <span class='comment val'># assign the new secondary model (replace the old)</span>

      <span class='elsif elsif kw'>elsif</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:on_edit</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;force_create&quot;</span> <span class='comment val'># force create a new item</span>
        <span class='sm_clone identifier id'>sm_clone</span> <span class='assign token'>=</span> <span class='sm identifier id'>sm</span><span class='dot token'>.</span><span class='clone identifier id'>clone</span>
        <span class='sm_clone identifier id'>sm_clone</span><span class='dot token'>.</span><span class='push identifier id'>push</span> <span class='string val'>&quot;clone&quot;</span> 
        <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='call_func identifier id'>call_func</span><span class='lparen token'>(</span><span class='ar identifier id'>ar</span><span class='comma token'>,</span> <span class='sm_clone identifier id'>sm_clone</span><span class='rparen token'>)</span>
        <span class='call_func identifier id'>call_func</span><span class='lparen token'>(</span><span class='ar identifier id'>ar</span><span class='comma token'>,</span> <span class='sm identifier id'>sm</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='rparen token'>)</span>  
      <span class='end end kw'>end</span>

    <span class='end end kw'>end</span>
    <span class='call_func identifier id'>call_func</span><span class='lparen token'>(</span><span class='ar identifier id'>ar</span><span class='comma token'>,</span> <span class='key_array identifier id'>key_array</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='save identifier id'>save</span>                             <span class='comment val'>#save the primary model</span>

  <span class='secondary_models identifier id'>secondary_models</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='model identifier id'>model</span><span class='bitor op'>|</span>    <span class='comment val'>#save the secondary models</span>
    <span class='model identifier id'>model</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span><span class='string val'>'save'</span><span class='rparen token'>)</span>
    <span class='call_func identifier id'>call_func</span><span class='lparen token'>(</span><span class='ar identifier id'>ar</span><span class='comma token'>,</span> <span class='model identifier id'>model</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='s identifier id'>s</span> <span class='assign token'>=</span> <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span>
  <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:include</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>        <span class='comment val'># add assotiations if requested {attr_id, attr : {id: ...</span>
    <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:include</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='j identifier id'>j</span><span class='bitor op'>|</span>
      <span class='s identifier id'>s</span><span class='lbrack token'>[</span><span class='j identifier id'>j</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='j identifier id'>j</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='s identifier id'>s</span>  
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="filter_sort-instance_method">
  
    - (<tt>Hash</tt>) <strong>filter_sort</strong>(opts = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Transform Ext provided :sort / :dir options into rail&#8217;s :order
options
</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h3>Examples:</h3>
    
      <h4><div class='inline'></div></h4>
      <pre class="example code"><span class='filter_sort identifier id'>filter_sort</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:sort</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;name&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:dir=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;ASC&quot;</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; {:order =&gt; &quot;name ASC&quot;}</span>
</pre>
    
      <h4><div class='inline'></div></h4>
      <pre class="example code"><span class='filter_sort identifier id'>filter_sort</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:sort</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='lbrace token'>{</span><span class='symbol val'>:sort=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;name&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:dir=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;ASC&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='lbrace token'>{</span><span class='symbol val'>:sort=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;country&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:dir=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;DESC&quot;</span><span class='rbrace token'>}</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; {:order =&gt; &quot;name ASC, country DESC&quot;}</span>
</pre>
    
  </div>
<h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>the</span>
      
      
      
        &mdash;
        <div class='inline'><p>
options used to find records
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>opts</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
a customizable set of options
</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <h3>Options Hash (<tt>opts</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:sort</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the attributes that must be used to sort
</p>
</div>
        </tr>
      
        <li>
          <span class="type">(<tt>String</tt>)</span>
          <span class="name">:dir</span>
          <span class="default">
            
              <span class="na">N/A</span>
            
          </span>
          &mdash;<div class='inline'><p>
the direction of the sort
</p>
</div>
        </tr>
      
    </ul>
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the provided options with :sort/:dir replaced by :order
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 104</span>

<span class='def def kw'>def</span> <span class='filter_sort identifier id'>filter_sort</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:sort</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span>
    <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:sort</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span> <span class='Array constant id'>Array</span><span class='rparen token'>)</span>
      <span class='s identifier id'>s</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
      <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:sort</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='sort identifier id'>sort</span><span class='bitor op'>|</span>
        <span class='sort_name identifier id'>sort_name</span> <span class='assign token'>=</span> <span class='sort identifier id'>sort</span><span class='lbrack token'>[</span><span class='symbol val'>:sort</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>&quot;.&quot;</span><span class='rparen token'>)</span>

        <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='push identifier id'>push</span> <span class='dstring node'>&quot;#{filter_sort_tables sort[:sort]} #{sort[:dir]}&quot;</span>
      <span class='end end kw'>end</span>
      <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span> <span class='symbol val'>:sort</span>
      <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:order</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;,&quot;</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='sort identifier id'>sort</span><span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span> <span class='symbol val'>:sort</span>
      <span class='dir identifier id'>dir</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span> <span class='symbol val'>:dir</span> <span class='orop op'>||</span> <span class='string val'>&quot;ASC&quot;</span>
      <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:order</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{filter_sort_tables sort} #{dir}&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='opts identifier id'>opts</span> 
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="filter_sort_tables-instance_method">
  
    - (<tt>Object</tt>) <strong>filter_sort_tables</strong>(v) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Transform a request to sort on a linked model into the table names
</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h3>Examples:</h3>
    
      <h4><div class='inline'></div></h4>
      <pre class="example code"><span class='filter_sort_tables identifier id'>filter_sort_tables</span> <span class='string val'>&quot;artist.name&quot;</span> <span class='comment val'>#=&gt; &quot;artists.name&quot;</span>
</pre>
    
      <h4><div class='inline'></div></h4>
      <pre class="example code"><span class='filter_sort_tables identifier id'>filter_sort_tables</span> <span class='string val'>&quot;artist.country.name&quot;</span> <span class='comment val'>#=&gt; &quot;countries.name&quot;</span>
</pre>
    
  </div>
<h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <span class='name'>v</span>
      
      
      
        &mdash;
        <div class='inline'><p>
a sort options provided by Ext
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'></span>
      
      
      
      
        
        <div class='inline'><p>
the name of the attributes prefixed with a table name
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


84
85
86
87
88
89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 84</span>

<span class='def def kw'>def</span> <span class='filter_sort_tables identifier id'>filter_sort_tables</span><span class='lparen token'>(</span><span class='v identifier id'>v</span><span class='rparen token'>)</span>
  <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>&quot;.&quot;</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='eq op'>==</span> <span class='integer val'>1</span>
    <span class='return return kw'>return</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='rbrack token'>]</span><span class='assign token'>=</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='pluralize identifier id'>pluralize</span>
  <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;.&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_total_count-instance_method">
  
    - (<tt>Integer</tt>) <strong>get_total_count</strong>(opts = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Get the total count for a find query ignoring limits
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>opts</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
the options for a ActiveRecord::Base.find call
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the total number of rows for the query ignoring limit and offset
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39
40
41
42
43</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/active_ext_api/active_ext_api.rb', line 37</span>

<span class='def def kw'>def</span> <span class='get_total_count identifier id'>get_total_count</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> 
    <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:limit</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
    <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:offset</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
    <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:select</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;count(*)&quot;</span>
    <span class='sql_count identifier id'>sql_count</span> <span class='assign token'>=</span> <span class='construct_finder_sql identifier id'>construct_finder_sql</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
    <span class='count_by_sql identifier id'>count_by_sql</span><span class='lparen token'>(</span><span class='sql_count identifier id'>sql_count</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sun Aug 22 22:47:54 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>
  0.5.8 (ruby-1.8.7).
</div>

  </body>
</html>